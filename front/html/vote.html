<auto-title title="YNFG Butthole Chart Voting"></auto-title>
<div class="CharCard">
	<div class="CharCardTitleContainer" id="CharTitle"><div>Game Title - Char Name</div></div>
	<div class="CharCardImageContainer"><img id="CharImage" class="CharImg"/></div>
	<div class="CharCardTextContainer" id="CharDesc">Char Description</div>
</div>
<div class="Sliders">

	<div class="SliderTitle">Color</div>
	<div class="SliderContainer">
		<input id="ColorSlider" type="range"
		min="0"
		max="100"
		step="1"
		value="50">
	</div>
	<div class="SliderTitle">Hairness</div>
	<div class="SliderContainer">
		<input id="HairSlider" type="range"
		min="0"
		max="100"
		step="1"
		value="50">
	</div>
	<div class="SliderTitle">Tightness</div>
	<div class="SliderContainer">
		<input id="TightSlider" type="range"
		min="0"
		max="100"
		step="1"
		value="50">
	</div>
</div>
<div class="VoteSendContainer">
	<div class="VoteSend" id="VoteSend">Vote!</div>
</div>
<script src="src/sliderTooltip.js"></script>
<div>
	<script>
		(()=>{
		if(!localStorage.started) 
		{
			window.history.pushState(null, null, "/");
			return;
		}

		let displayedCharacter = "none";
		fetch("/api/r").then(res=>{res.text().then((char)=>{
	
			if(char == "TheVoteIsDone") 
			{
				window.history.pushState(null, null, `/end`);
				return;
			}
	
			CharImage.src = `/media/chars/${char}/pic.png`;
			displayedCharacter = char;
			fetch(`/media/chars/${char}/info.json`)
			.then(response => response.json())
			.then(data => {
				CharTitle.innerText = data.title;
				CharDesc.innerText = data.description;
			})
			.catch(error => {
			  console.error('Error loading JSON:', error);
			});
		})});
	
		VoteSend.onclick = async ()=>
		{
			await fetch('/api/v',
			{
				method: 'POST',
				cache: "no-store",
				headers: 
				{
					'Content-Type': 'application/json'
				},
				body: JSON.stringify({char: displayedCharacter, color: ColorSlider.value, hair: HairSlider.value, tight: TightSlider.value})
			});
			setTimeout(()=>{
				window.location = '/vote';
			}, 100);
		}
	})();
	</script>
</div>